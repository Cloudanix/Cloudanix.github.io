"use strict";(self.webpackChunkcloudanix_docs=self.webpackChunkcloudanix_docs||[]).push([[66526],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return d}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=i,f=m["".concat(c,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(f,a(a({ref:t},s),{},{components:n})):r.createElement(f,a({ref:t},s))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var p=2;p<o;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},48417:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var r=n(83117),i=n(80102),o=(n(67294),n(3905)),a=(n(44996),["components"]),l={},c=void 0,p={unversionedId:"aws/audit/cloudwatchmonitoring/rules/vpc_flow_logs_metric_filter_remediation",id:"aws/audit/cloudwatchmonitoring/rules/vpc_flow_logs_metric_filter_remediation",title:"vpc_flow_logs_metric_filter_remediation",description:"Remediation",source:"@site/docs/aws/audit/cloudwatchmonitoring/rules/vpc_flow_logs_metric_filter_remediation.md",sourceDirName:"aws/audit/cloudwatchmonitoring/rules",slug:"/aws/audit/cloudwatchmonitoring/rules/vpc_flow_logs_metric_filter_remediation",permalink:"/aws/audit/cloudwatchmonitoring/rules/vpc_flow_logs_metric_filter_remediation",draft:!1,tags:[],version:"current",frontMatter:{}},s={},u=[{value:"Remediation",id:"remediation",level:3},{value:"Using AWS Console",id:"using-aws-console",level:4}],m={toc:u};function d(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"remediation"},"Remediation"),(0,o.kt)("p",null,"How to create and configure the required CloudWatch alarm for the VPC Flow Logs metric filter?"),(0,o.kt)("h4",{id:"using-aws-console"},"Using AWS Console"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 1: In the navigation panel, select Topics and click the Create topic button.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 2: In the Create topic dialog box, enter a name and a display name for your new SNS topic then click Create topic.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 3: The page will redirect to newly created SNS topic configuration page or open by clicking on its Amazon Resource Name (ARN) link in SNS Topics.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 4: Under Subscriptions section click Create Subscription.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 5: Select Email as subscription protocol from the Protocol dropdown list.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 6: In the Endpoint box, enter the email address where you want to receive the AWS CloudWatch alarm notifications then click Create Subscription to create the required subscription.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 7: Use your preferred email client application to open the message received from AWS Notifications, then click on Confirm subscription link, i.e.\nto confirm your new email subscription.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 8: Now navigate to CloudWatch dashboard at ",(0,o.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/cloudwatch/"},"https://console.aws.amazon.com/cloudwatch/"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 9: In the left navigation panel, click Logs.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},'Step 10: Select your VPC Flow Logs CloudWatch log group and click on the "number" filter link, available in the Metric Filters column, to access the metric filters page for the selected group.')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 11: On Filters for <vpc_flow_log_group_name> page, choose the metric filter that you want to configure (see Audit section part I to identify the right metric filter), then click Create alarm link available in the Metric filters section to initiate the CloudWatch alarm setu\np process.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Step 12: Within Create Alarm page, provide the following information:\nA: In the Specify metric and conditions section, select 5 Minutes from the Period dropdown list and Sum from the Statistic list."),(0,o.kt)("p",{parentName:"li"},"  B: In the Specify metric and conditions section, under Whenever: Metric Name select >= (greater than or equal to) and enter 1 as the threshold value in the box to trigger the alarm every time IP packets are rejected inside your VPC."),(0,o.kt)("p",{parentName:"li"},"  C: In the Configure actions section, under Notification, select In alarm in the Alarm state trigger section and choose the AWS SNS topic name created earlier from Send notification to dropdown list."),(0,o.kt)("p",{parentName:"li"},"  D: Inside the Add name and description section, in the Alarm name and Alarm description boxes, provide a unique name and a short description for your new CloudWatch alarm."),(0,o.kt)("p",{parentName:"li"},"  E: In the Preview and create section, review the alarm configuration details then click Create Alarm. Once created, the new CloudWatch alarm will be listed on the Alarms page. After the monitoring data is loaded, the State (status) of the new CloudWatch alarm will change from Insufficient data to OK."))))}d.isMDXComponent=!0}}]);