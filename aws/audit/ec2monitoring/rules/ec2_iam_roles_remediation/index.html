<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-aws/audit/ec2monitoring/rules/ec2_iam_roles_remediation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">ec2_iam_roles_remediation | Cloudanix Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cloudanix.com/aws/audit/ec2monitoring/rules/ec2_iam_roles_remediation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ec2_iam_roles_remediation | Cloudanix Docs"><meta data-rh="true" name="description" content="Remediation"><meta data-rh="true" property="og:description" content="Remediation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cloudanix.com/aws/audit/ec2monitoring/rules/ec2_iam_roles_remediation"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/ec2monitoring/rules/ec2_iam_roles_remediation" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/ec2monitoring/rules/ec2_iam_roles_remediation" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5b2fef61.css">
<link rel="preload" href="/assets/js/runtime~main.b141e21b.js" as="script">
<link rel="preload" href="/assets/js/main.eb2826a8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Documentation</b></a><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.cloudanix.com?ref=docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cloudanix Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ec2_iam_roles_remediation</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediation">Remediation<a href="#remediation" class="hash-link" aria-label="Direct link to Remediation" title="Direct link to Remediation">​</a></h3><p>How to implement IAM role based access for existing instances?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-aws-console">Using AWS Console<a href="#using-aws-console" class="hash-link" aria-label="Direct link to Using AWS Console" title="Direct link to Using AWS Console">​</a></h4><ul><li><p>Step 1: In the left navigation panel, choose Roles. On the Roles page, click Create New Role to set up a new IAM role that your instance(s) can assume by performing the following actions:
A: In the Role Name field enter a name for the role. Choose a name that will reflect the purpose of the role (e.g. EC2-Admin-Role) and click Next Step.
B: Choose the AWS Service Roles section and then select the Amazon EC2 option.
C: On the Attach Policy page, select the access policy to attach to the IAM role. This policy defines what actions your application can take and what AWS resources can access. As example, we will use the AmazonEC2FullAccess policy, which provides full access to all AWS EC2 services and resources (EC2, ELB, ASG, etc). You can also create your own custom policy using the AWS Policy Generator:
<a href="https://awspolicygen.s3.amazonaws.com/policygen.html" target="_blank" rel="noopener noreferrer">https://awspolicygen.s3.amazonaws.com/policygen.html</a>. Click Next Step to continue.
D: On the Review page, review the role information (name, ARN, etc) and click Create Role to generate the new IAM role.</p></li><li><p>Step 2: Now it’s time to create an image (AMI) from your running EC2 instance. To instantiate the Amazon Machine Image (AMI), perform the following:
A: Navigate to EC2 dashboard at <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">https://console.aws.amazon.com/ec2/</a>.
B: In the left navigation panel, under INSTANCES section, choose Instances.
C: Select the EC2 instance that requires roles for AWS API access (see the Audit section to identify any EC2 instances without IAM roles associated).
D: Click the Actions dropdown button from the dashboard top menu, select Image and click Create Image
E: Inside Create Image dialog box, provide the following information:
a. Enter a name for the new AMI in the Image Name box.
b. In the Image description box, provide a description that reflects the usage of the EC2 instance selected.
c. Leave No reboot option unchecked so the AWS can guarantee the file system integrity for the new image.
F: Click Create Image to submit the request to create the image. Click Close to return to the EC2 dashboard. The AMI creation may take few minutes. Once the process is complete the image status should change from pending to available.</p></li><li><p>Step 3: Once the AMI is ready, use it to (re)launch the selected EC2 instance and attach the IAM role created earlier. To launch the instance, perform the following actions:
A: In the navigation panel, under INSTANCES section, select Instances.
B: Click the Launch Instance button from the EC2 dashboard top menu to initiate the process.
C: On the Choose an Amazon Machine Image (AMI) page, choose My AMIs tab then select the AMI created at step no. 5.
D: On the Choose an Instance Type page, select the same instance type used then click Next: Configure Instance Details button.
E: On the Configure Instance Details page, select the newly created role from the IAM role dropdown list and configure any other options available on the page based on your running instance requirements. Click Next: Add Storage and go through the next pages until you reach the Configure Security Group page, without changing any configuration.
F: On the Configure Security Groups, choose Select an existing security group and select the existing instance security group. Click the Review and Launch button, review your instance configuration details and click Launch.
G: In the Select an existing key pair or create a new key pair dialog box, select Choose an existing key pair and use the same key pair as the running EC2 instance. Check I acknowledge that I have access to the selected private key file option then click Launch Instances.
H: Click View Instances to return to the Instances page. The new instance will have the same data and configuration (except the new attached role) as the existing (old) EC2 instance.</p></li><li><p>Step 4: Once you have verified and tested the new instance, you can transfer the Elastic IP (EIP) from the old EC2 instance to the new instance for reference purposes. If the old instance does not have an EIP attached you will have to update the domain DNS record(s) or any other application references to switch to the new instance IP. To transfer the Elastic IP, perform the following actions:
A: In the navigation panel, under NETWORK &amp; SECURITY section, select Elastic IPs.
B: Select the EIP address attached to the old running instance, click the Actions dropdown button then select Disassociate Address.
C: In the Disassociate Address dialog box, review the details then click Yes, Disassociate.
D: Select the same address, disassociated in the previous step, click the Actions dropdown button then select Associate Address.
E: In the Associate Address dialog box, select the new EC2 instance created at step no. 6 from the Instance dropdown list and then click Associate to attach the EIP.</p></li><li><p>Step 5: Now it’s safe to terminate the old EC2 instance in order to stop incurring charges for it. To shut down the instance, perform the following:
A: In the navigation panel, under INSTANCES section, select Instances.
B: Select the EC2 instance that you want to terminate.
C: Click the Actions dropdown button from the dashboard top menu, select Instance State, and click Terminate.
D: In the Terminate Instances confirmation box, review the instance details then click Yes, Terminate.</p></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#remediation" class="table-of-contents__link toc-highlight">Remediation</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Twitter</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Cloudanix. Assembled using Clouds.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b141e21b.js"></script>
<script src="/assets/js/main.eb2826a8.js"></script>
</body>
</html>