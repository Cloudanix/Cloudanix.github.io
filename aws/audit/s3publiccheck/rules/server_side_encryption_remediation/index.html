<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-aws/audit/s3publiccheck/rules/server_side_encryption_remediation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">server_side_encryption_remediation | Cloudanix Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cloudanix.com/aws/audit/s3publiccheck/rules/server_side_encryption_remediation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="server_side_encryption_remediation | Cloudanix Docs"><meta data-rh="true" name="description" content="Remediation"><meta data-rh="true" property="og:description" content="Remediation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cloudanix.com/aws/audit/s3publiccheck/rules/server_side_encryption_remediation"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/s3publiccheck/rules/server_side_encryption_remediation" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/s3publiccheck/rules/server_side_encryption_remediation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloudanix Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloudanix Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a6182ea2.css">
<link rel="preload" href="/assets/js/runtime~main.2c7d9858.js" as="script">
<link rel="preload" href="/assets/js/main.aab08b52.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Documentation</b></a><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.cloudanix.com?ref=docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cloudanix Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>server_side_encryption_remediation</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediation">Remediation<a href="#remediation" class="hash-link" aria-label="Direct link to Remediation" title="Direct link to Remediation">​</a></h3><p>How to ensure that your S3 buckets are protecting their sensitive data at rest by enforcing Server-Side Encryption?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-aws-console">Using AWS Console<a href="#using-aws-console" class="hash-link" aria-label="Direct link to Using AWS Console" title="Direct link to Using AWS Console">​</a></h4><ul><li><p>Step 1: Select the S3 bucket to reconfigure (see Audit section part I to identify the right resource) and click the Properties tab from the dashboard top-right menu:
</p></li><li><p>Step 2: click Permissions and then Click the Edit bucket policy button. If the selected bucket does not have an access policy defined, click Add bucket policy</p></li><li><p>Step 3: In the Bucket Policy Editor dialog box, perform one of the following actions based on your configuration:
A: If there is no access policy currently in use, paste the following policy document in the Bucket Policy Editor box, replace the bucket name, i.e. cc-client-data, with the name of your own S3 bucket then click Save. This policy will enforce the owner and the users that have access to the bucket to enable Server-Side Encryption for every object uploaded via Management Console or via AWS API:
{
&quot;Version&quot;: &quot;2012-10-17&quot;,
&quot;Id&quot;: &quot;PutObjPolicy&quot;,
&quot;Statement&quot;: <!-- -->[
{
&quot;Sid&quot;: &quot;DenyIncorrectEncryptionHeader&quot;,
&quot;Effect&quot;: &quot;Deny&quot;,
&quot;Principal&quot;: &quot;<em>&quot;,
&quot;Action&quot;: &quot;s3:PutObject&quot;,
&quot;Resource&quot;: &quot;arn:aws:s3:::cc-client-data/</em>&quot;,
&quot;Condition&quot;: {
&quot;StringNotEquals&quot;: {
&quot;s3:x-amz-server-side-encryption&quot;: &quot;AES256&quot;
}
}
},
{
&quot;Sid&quot;: &quot;DenyUnEncryptedObjectUploads&quot;,
&quot;Effect&quot;: &quot;Deny&quot;,
&quot;Principal&quot;: &quot;<em>&quot;,
&quot;Action&quot;: &quot;s3:PutObject&quot;,
&quot;Resource&quot;: &quot;arn:aws:s3:::cc-client-data/</em>&quot;,
&quot;Condition&quot;: {
&quot;Null&quot;: {
&quot;s3:x-amz-server-side-encryption&quot;: &quot;true&quot;
}
}
}
]<!-- -->
}
B: If the selected bucket has already an access policy implemented, Add the following policy statements (highlighted) to the existing ones available within the Bucket Policy Editor box, as shown in the following example:
{
&quot;Id&quot;: &quot;S3BucketAccessPolicy&quot;,
&quot;Version&quot;: &quot;2012-10-17&quot;,
&quot;Statement&quot;: <!-- -->[
{
...
},
{
<strong>&quot;Sid&quot;: &quot;DenyIncorrectEncryptionHeader&quot;,</strong>
<strong>&quot;Effect&quot;: &quot;Deny&quot;,</strong>
<strong>&quot;Principal&quot;: &quot;*&quot;,</strong>
<strong>&quot;Action&quot;: &quot;s3:PutObject&quot;,</strong>
<strong>&quot;Resource&quot;: &quot;arn:aws:s3:::cc-client-data/*&quot;,</strong>
<strong>&quot;Condition&quot;: {</strong>
<strong>&quot;StringNotEquals&quot;: {</strong>
<strong>&quot;s3:x-amz-server-side-encryption&quot;: &quot;AES256&quot;</strong>
<strong>}</strong>
<strong>}</strong>
<strong>},</strong>
<strong>{</strong>
<strong>&quot;Sid&quot;: &quot;DenyUnEncryptedObjectUploads&quot;,</strong>
<strong>&quot;Effect&quot;: &quot;Deny&quot;,</strong>
<strong>&quot;Principal&quot;: &quot;*&quot;,</strong>
<strong>&quot;Action&quot;: &quot;s3:PutObject&quot;,</strong>
<strong>&quot;Resource&quot;: &quot;arn:aws:s3:::cc-client-data/*&quot;,</strong>
<strong>&quot;Condition&quot;: {</strong>
<strong>&quot;Null&quot;: {</strong>
<strong>&quot;s3:x-amz-server-side-encryption&quot;: &quot;true&quot;</strong>
<strong>}</strong>
<strong>}</strong>
<strong>}</strong>
]<!-- -->
}
Replace the bucket name, i.e. cc-client-data, with your own bucket then click the Save to apply the policy changes. This policy will enforce the owner and the users that have access to the bucket to enable Server-Side Encryption for every object uploaded via Management Console, via CLI or programmatically via AWS API.</p></li><li><p>Step 7: To test the Server-Side Encryption feature implementation, perform the following actions:
A: Select the SSE-enabled S3 bucket and click the Upload from the dashboard top menu.
B: In the Upload - Select Files and Folders dialog box, click Add files to upload a simple text file.
C: Click Set Details button to set additional details for the object uploaded at the previous step.
D: On the Set Details page, check Use Server Side Encryption checkbox then click Start Upload to upload the file to your bucket. If your file is uploaded to S3 without returning any errors during the process, the Server-Side Encryption has been successfully enabled.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="default-encryption"><strong>Default Encryption</strong><a href="#default-encryption" class="hash-link" aria-label="Direct link to default-encryption" title="Direct link to default-encryption">​</a></h4><ul><li><p>Step 1: Click on the name/link of the S3 bucket you want to reconfigure (see Audit section part I to identify the right resource).</p></li><li><p>Step 2: Select the Properties tab from the S3 dashboard top menu and click on the Default encryption feature configuration box.</p></li><li><p>Step 3: Inside the box, select one of the following options, based on your requirements:
A: Select AES-256 option to use Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3) to encrypt your S3 objects automatically at upload.
B: Select AWS-KMS option to use Server-Side Encryption with AWS KMS-Managed Keys (SSE-KMS) to encrypt your S3 objects. If you choose this option, you must select a KMS-managed key from Select a key dropdown list or provide the ARN of your custom key inside Custom KMS ARN box.</p></li><li><p>Step 4: Click Save to apply the changes and enable default encryption for the selected Amazon S3 bucket.</p></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#remediation" class="table-of-contents__link toc-highlight">Remediation</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Twitter</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Cloudanix. Assembled using Clouds.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2c7d9858.js"></script>
<script src="/assets/js/main.aab08b52.js"></script>
</body>
</html>