<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-aws/audit/cloudwatchmonitoring/rules/console_sign_in_without_mfa_remediation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">console_sign_in_without_mfa_remediation | Cloudanix Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cloudanix.com/aws/audit/cloudwatchmonitoring/rules/console_sign_in_without_mfa_remediation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="console_sign_in_without_mfa_remediation | Cloudanix Docs"><meta data-rh="true" name="description" content="Remediation"><meta data-rh="true" property="og:description" content="Remediation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cloudanix.com/aws/audit/cloudwatchmonitoring/rules/console_sign_in_without_mfa_remediation"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/cloudwatchmonitoring/rules/console_sign_in_without_mfa_remediation" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cloudanix.com/aws/audit/cloudwatchmonitoring/rules/console_sign_in_without_mfa_remediation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloudanix Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloudanix Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a6182ea2.css">
<link rel="preload" href="/assets/js/runtime~main.2c7d9858.js" as="script">
<link rel="preload" href="/assets/js/main.aab08b52.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Cloudanix Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Documentation</b></a><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.cloudanix.com?ref=docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cloudanix Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>console_sign_in_without_mfa_remediation</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediation">Remediation<a href="#remediation" class="hash-link" aria-label="Direct link to Remediation" title="Direct link to Remediation">​</a></h3><p>How to monitor AWS console sign in without MFA?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-aws-console">Using AWS Console<a href="#using-aws-console" class="hash-link" aria-label="Direct link to Using AWS Console" title="Direct link to Using AWS Console">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="create-sns-topic-and-the-necessary-subscription-to-send-notification-alerts-whenever-the-necessary-aws-cloudwatch-alarm-is-triggered">Create SNS topic and the necessary subscription to send notification alerts whenever the necessary AWS CloudWatch alarm is triggered:<a href="#create-sns-topic-and-the-necessary-subscription-to-send-notification-alerts-whenever-the-necessary-aws-cloudwatch-alarm-is-triggered" class="hash-link" aria-label="Direct link to Create SNS topic and the necessary subscription to send notification alerts whenever the necessary AWS CloudWatch alarm is triggered:" title="Direct link to Create SNS topic and the necessary subscription to send notification alerts whenever the necessary AWS CloudWatch alarm is triggered:">​</a></h5><ul><li><p>Step 1: In the navigation panel, select Topics and click the Create new topic button.</p></li><li><p>Step 2: In the Create new topic dialog box, enter a name and a display name for your new SNS topic then click Create Topic.</p></li><li><p>Step 3: Open the newly created SNS topic configuration page by clicking on its Amazon Resource Name (ARN) link.</p></li><li><p>Step 4: Under Subscription section click Create Subscription.</p></li><li><p>Step 5: Select Email as subscription protocol from the Protocol dropdown list.</p></li><li><p>Step 6: In the Endpoint box, enter the email address where you want to receive the CloudWatch alarm notifications then click Create Subscription to create the required subscription.</p></li><li><p>Step 7: Use your preferred email client application to open the message received from AWS Notifications, then click on the appropriate link to confirm your new email subscription.</p></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-required-cloudwatch-metric-filter-and-the-cloudwatch-alarm-that-will-fire-whenever-an-aws-management-console-sign-in-request-made-without-using-mfa-is-send">Create the required CloudWatch metric filter and the CloudWatch alarm that will fire whenever an AWS Management Console sign-in request made without using MFA is send:<a href="#create-the-required-cloudwatch-metric-filter-and-the-cloudwatch-alarm-that-will-fire-whenever-an-aws-management-console-sign-in-request-made-without-using-mfa-is-send" class="hash-link" aria-label="Direct link to Create the required CloudWatch metric filter and the CloudWatch alarm that will fire whenever an AWS Management Console sign-in request made without using MFA is send:" title="Direct link to Create the required CloudWatch metric filter and the CloudWatch alarm that will fire whenever an AWS Management Console sign-in request made without using MFA is send:">​</a></h5><ul><li><p>Step 1: In the left navigation panel, select Logs.</p></li><li><p>Step 2: Select the log group created for your CloudTrail trail event logs and click Create Metric Filter button.</p></li><li><p>Step 3: On the Define Logs Metric Filter page, paste the following pattern inside the Filter Pattern box: { $.eventName = &quot;ConsoleLogin&quot; &amp;&amp; $.additionalEventData.MFAUsed = &quot;No&quot; }. This pattern will be used for scanning AWS CloudTrail logs for authentication-specific events named &quot;ConsoleLogin&quot; that have the &quot;additionalEventData.MFAUsed&quot; event attribute assigned.</p></li><li><p>Step 4: Review the metric filter configuration details then click Assign Metric.</p></li><li><p>Step 5: On the Create Metric Filter and Assign a Metric page, perform the following:
A: In the Filter Name box, enter ConsoleSignInWithoutMfa as the name for the new filter.</p><p>  B: In the Metric Namespace box, type CloudTrailMetrics.</p><p>  C: In the Metric Name box, type ConsoleSignInWithoutMfaCount for the metric identifier.</p><p>  D: Click Show advanced metric settings to slide down the advanced settings section.</p><p>  E: In the Metric Value box, enter 1.</p></li><li><p>Step 6: Review the details then click Create Filter to generate your new CloudWatch Logs metric filter.</p></li><li><p>Step 7: On the current page click Create Alarm from the top-right menu.</p></li><li><p>Step 8: In the Create Alarm dialog box, provide the following information:
A: Within the Alarm Threshold section, in the Name and Description fields, enter a unique name (e.g. ConsoleSignInWithoutMfaAlarm) and a short description for the new CloudWatch alarm.</p><p>  B: Under Whenever: Metric Name, select &gt;= (greater than or equal to) from the is dropdown list and enter 1 as the threshold value in the box next to the dropdown list to trigger the alarm every time a sign-in request made without using MFA is performed.</p><p>  C: In the Actions section, click the + Notification button, select State is ALARM from the Whenever this alarm dropdown menu and choose the AWS SNS topic name created at Step 1 from Send notification to.</p><p>  D: In the Alarm Preview section, select 5 Minutes from the Period dropdown list and Sum from the Statistic list.</p><p>  E: Review the CloudWatch alarm configuration details then click Create Alarm. Once created, the new alarm will be listed on the Alarms page. Once the monitoring data is loaded, the State (status) of the new CloudWatch alarm will change from INSUFFICIENT_DATA to OK.</p></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#remediation" class="table-of-contents__link toc-highlight">Remediation</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudanix.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Twitter</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/cloudanix" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Cloudanix. Assembled using Clouds.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2c7d9858.js"></script>
<script src="/assets/js/main.aab08b52.js"></script>
</body>
</html>